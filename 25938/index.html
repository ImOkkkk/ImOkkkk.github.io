<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="baidu-site-verification" content="bUCDF5pEQe">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=66522575" charset="UTF-8"></script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tonymua.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="1.视图视图就是封装了一条复杂查询的语句。语法 1.：CREATE VIEW 视图名称 AS 子查询  如果视图已经存在我们可以使用语法 2 来创建视图，这样已有的视图会被覆盖。  语法 2：CREATE OR REPLACE VIEW 视图名称 AS 子查询  我们可以设置视图为只读。语法 3：CREATE OR REPLACE VIEW 视图名称 AS 子查询 WITH READ ONLY">
<meta name="keywords" content="数据库">
<meta property="og:type" content="article">
<meta property="og:title" content="Oracle(二)">
<meta property="og:url" content="http://tonymua.top/25938/index.html">
<meta property="og:site_name" content="ImOkkkk BLOG">
<meta property="og:description" content="1.视图视图就是封装了一条复杂查询的语句。语法 1.：CREATE VIEW 视图名称 AS 子查询  如果视图已经存在我们可以使用语法 2 来创建视图，这样已有的视图会被覆盖。  语法 2：CREATE OR REPLACE VIEW 视图名称 AS 子查询  我们可以设置视图为只读。语法 3：CREATE OR REPLACE VIEW 视图名称 AS 子查询 WITH READ ONLY">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-04-29T02:44:38.075Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Oracle(二)">
<meta name="twitter:description" content="1.视图视图就是封装了一条复杂查询的语句。语法 1.：CREATE VIEW 视图名称 AS 子查询  如果视图已经存在我们可以使用语法 2 来创建视图，这样已有的视图会被覆盖。  语法 2：CREATE OR REPLACE VIEW 视图名称 AS 子查询  我们可以设置视图为只读。语法 3：CREATE OR REPLACE VIEW 视图名称 AS 子查询 WITH READ ONLY">

<link rel="canonical" href="http://tonymua.top/25938/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Oracle(二) | ImOkkkk BLOG</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="ImOkkkk BLOG" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ImOkkkk BLOG</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">When they go low,we go high.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">56</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">33</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">12</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://tonymua.top/25938/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/../assets/img/head.jpg">
      <meta itemprop="name" content="ImOkkkk">
      <meta itemprop="description" content="Java开发, 后端开发">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ImOkkkk BLOG">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Oracle(二)
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-05-08 21:19:59" itemprop="dateCreated datePublished" datetime="2021-05-08T21:19:59+08:00">2021-05-08</time>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h4 id="1-视图"><a href="#1-视图" class="headerlink" title="1.视图"></a>1.视图</h4><p>视图就是封装了一条复杂查询的语句。<br>语法 1.：CREATE VIEW 视图名称 AS 子查询 </p>
<p>如果视图已经存在我们可以使用语法 2 来创建视图，这样已有的视图会被覆盖。 </p>
<p>语法 2：CREATE OR REPLACE VIEW 视图名称 AS 子查询 </p>
<p>我们可以设置视图为只读。<br>语法 3：CREATE OR REPLACE VIEW 视图名称 AS 子查询 WITH READ ONLY </p>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">--视图:视图就是提供一个查询的窗口,所有数据来自于原表</span><br><span class="line">--查询语句创建表</span><br><span class="line">create table emp as select * from scott.emp;</span><br><span class="line">select * from emp;</span><br><span class="line">--创建视图(必须有dba权限)</span><br><span class="line">create view v_emp as select ename,job from emp;</span><br><span class="line">--查询视图</span><br><span class="line">select * from v_emp;</span><br><span class="line">--修改视图(不推荐)</span><br><span class="line">update v_emp set job=&apos;CLERK&apos; where ename=&apos;ALLEN&apos;;</span><br><span class="line">commit;</span><br><span class="line">--创建只读视图</span><br><span class="line">create view v_emp_readonly as select ename,job from emp with read only;</span><br><span class="line">--视图的作用</span><br><span class="line">--1.视图可以屏蔽掉一些敏感字段</span><br><span class="line">--2.保证总部和分布数据及时统一</span><br></pre></td></tr></table></figure>

<h4 id="2-索引"><a href="#2-索引" class="headerlink" title="2.索引"></a>2.索引</h4><p>​    索引是用于加速数据存取的数据对象。合理的使用索引可以大大降低 i/o 次数,从而 提高数据访问性能。索引有很多种我们主要介绍常用的几种: </p>
<p>​    为什么添加了索引之后，会加快查询速度呢？ </p>
<p>​    图书馆：如果杂乱地放书的话检索起来就非常困难,所以将书分类，然后再建一个箱子，箱 子里面放卡片，卡片里面可以按类查询,按书名查或者类别查,这样的话速度会快很多很多， 这个就有点像索引。索引的好处就是提高你找到书的速度，但是正是因为你建了索引，就应该有人 专门来维护索引，维护索引是要有时间精力的开销的，也就是说索引是不能乱建的，所以建索引有 个原则：如果有一个字段如果不经常查询，就不要去建索引。现在把书变成我们的表，把卡片变成 我们的索引，就知道为什么索引会快，为什么会有开销。 </p>
<p>创建索引的语法： 创建索引： </p>
<p>1．单列索引 单列索引是基于单个列所建立的索引，比如: </p>
<p>​        CREATE index 索引名  on 表名(列名)</p>
<p>2．复合索引 复合索引是基于两个列或多个列的索引。在同一张表上可以有多个索引，但是 要求列的组合必须不同,比如：</p>
<p>​    Create index emp_idx1 on emp(ename,job); </p>
<p>​    Create index emp_idx1 on emp(job,ename); </p>
<p>索引的使用原则： </p>
<p> 在大表上建立索引才有意义 </p>
<p> 在 where子句后面或者是连接条件上的字段建立索引 </p>
<p> 表中数据修改频率高时不建议建立索引 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">--索引:索引就是在表的列上构建一个二叉树</span><br><span class="line">--达到大幅度提高查询效率的目的,但是索引会影响增删改的效率</span><br><span class="line">--单列索引</span><br><span class="line">--创建单列索引</span><br><span class="line">create index idx_ename on emp(ename);</span><br><span class="line">--单列索引触发规则,条件必须是索引列中的原始值</span><br><span class="line">--单行函数,模糊查询都会影响索引的触发</span><br><span class="line">select * from emp where ename=&apos;SCOTT&apos;;</span><br><span class="line">--复合索引</span><br><span class="line">--创建复合索引</span><br><span class="line">create index idx_enamejob on emp(ename,job);</span><br><span class="line">--复合索引中第一列为优先检索列</span><br><span class="line">--如果要触发复合索引,必须包含优先检索列中的原始值</span><br><span class="line">select * from emp where ename=&apos;SCOTT&apos; and job=&apos;xx&apos;;--触发复合索引</span><br><span class="line">select * from emp where ename=&apos;SCOTT&apos; or job=&apos;xx&apos;;--不触发索引</span><br><span class="line">select * from emp where ename=&apos;SCOTT&apos;;--触发单列索引</span><br></pre></td></tr></table></figure>

<h4 id="3-pl-sql基本语法"><a href="#3-pl-sql基本语法" class="headerlink" title="3.pl/sql基本语法"></a>3.pl/sql基本语法</h4><p>什么是 PL/SQL? </p>
<p>​    PL/SQL（Procedure Language/SQL） PLSQL 是 Oracle 对sql 语言的过程化扩展，指在 SQL 命令语言中增加了过程处理语句（如分支、循 环等），使 SQL语言具有过程处理能力。把SQL 语言的数据操纵能力与过程语言的数据处理能力结合 起来，使得 PLSQL面向过程但比过程语言简单、高效、灵活和实用。 </p>
<h5 id="3-1-pl-sql程序语法"><a href="#3-1-pl-sql程序语法" class="headerlink" title="3.1 pl/sql程序语法"></a>3.1 pl/sql程序语法</h5><p>程序语法： </p>
<p>​    declare       说明部分    （变量说明，游标申明，例外说明 )  </p>
<p>​    begin       语句序列   （DML 语句〕…  </p>
<p>​    exception       例外处理语句    </p>
<p>​    End; </p>
<h5 id="3-2-常量和变量定义"><a href="#3-2-常量和变量定义" class="headerlink" title="3.2 常量和变量定义"></a>3.2 常量和变量定义</h5><p>​    在程序的声明阶段可以来定义常量和变量。 </p>
<p> 变量的基本类型就是 oracle 中的建表时字段的变量如 char, varchar2, date, number, boolean, long </p>
<p>​    定义语法：</p>
<p>​                varl  char(15);    </p>
<p>​                Psal  number(9,2); </p>
<p>​    说明变量名、数据类型和长度后用分号结束说明语句。 </p>
<p>​    常量定义：married   constant boolean:=true </p>
<p> 引用变量 Myname  emp.ename%type; </p>
<p>​    引用型变量，即my_name 的类型与emp 表中 ename 列的类型一样 在 sql中使用 into 来赋值</p>
<p> 记录型变量 Emprec  emp%rowtype </p>
<p>​    记录变量分量的引用 emp_rec.ename:=’ADAMS’; </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">--pl/sql编程语言</span><br><span class="line">--pl/sql编程语言是对sql语言的扩展，使得sql语言具有过程化编程的特性</span><br><span class="line">--pl/sql编程语言比一般的过程化编程语言，更加灵活高效</span><br><span class="line">--pl/sql编程语言主要用来编写存储过程和存储函数等</span><br><span class="line"></span><br><span class="line">--声明方法</span><br><span class="line">--赋值操作可以使用:=也可以使用into查询语句赋值</span><br><span class="line">declare</span><br><span class="line">    i number(2):=10;</span><br><span class="line">    s varchar2(10):=&apos;小明&apos;;</span><br><span class="line">    ename emp.ename%type;--引用型变量</span><br><span class="line">    emprow emp%rowtype;--记录型变量</span><br><span class="line">begin</span><br><span class="line">    dbms_output.put_line(i);</span><br><span class="line">    dbms_output.put_line(s);</span><br><span class="line">    select ename into ename from emp where empno=7788;</span><br><span class="line">    dbms_output.put_line(ename);</span><br><span class="line">    select * into emprow from emp where empno=7788;</span><br><span class="line">    dbms_output.put_line(emprow.ename||&apos;的工作为:&apos;||emprow.job);</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>

<h5 id="3-3-if-分支"><a href="#3-3-if-分支" class="headerlink" title="3.3 if 分支"></a>3.3 if 分支</h5><p>语法 1： </p>
<p>​    IF   条件  THEN 语句 1;   </p>
<p>​        语句 2;      </p>
<p>​            END IF; </p>
<p>语法 2： </p>
<p>​    IF  条件  THEN  语句序列 1；</p>
<p>​        ELSE   语句序列 2；        </p>
<p>​            END   IF；  </p>
<p>语法 3： </p>
<p>​    IF   条件  THEN 语句; </p>
<p>​        ELSIF  语句  THEN  语句; </p>
<p>​            ELSE  语句; </p>
<p>​                END  IF;  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">--pl/sql中的if判断</span><br><span class="line">--输入小于18的数字，输出未成年</span><br><span class="line">--输入大于18小于40的数字，输出中年人</span><br><span class="line">--输入大于40的数字，输出老年人</span><br><span class="line">declare</span><br><span class="line">  i number(3):=&amp;ii;</span><br><span class="line">begin</span><br><span class="line">  if i&lt;18 then</span><br><span class="line">    dbms_output.put_line(&apos;未成年&apos;);</span><br><span class="line">  elsif i&lt;40 then</span><br><span class="line">    dbms_output.put_line(&apos;中年人&apos;);</span><br><span class="line">  else</span><br><span class="line">    dbms_output.put_line(&apos;老年人&apos;);</span><br><span class="line">  end if;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>

<h5 id="3-4-LOOP-循环语句"><a href="#3-4-LOOP-循环语句" class="headerlink" title="3.4 LOOP 循环语句"></a>3.4 LOOP 循环语句</h5><p>语法 1： </p>
<p>​    WHILE  total  &lt;= 25000  LOOP </p>
<p>​        .. . </p>
<p>​            total : = total + salary; </p>
<p>​                END  LOOP;  </p>
<p>语法 2： </p>
<p>​    Loop </p>
<p>​        EXIT [when   条件];</p>
<p>​             …… </p>
<p>​                End loop </p>
<p>语法 3： </p>
<p>​    FOR   I   IN   1 . . 3    LOOP </p>
<p>​        语句序列 ; </p>
<p>​            END    LOOP ;  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">--pl/sql中的loop循环</span><br><span class="line">--用三种方式输出1到10是个数字</span><br><span class="line">--while循环</span><br><span class="line">declare</span><br><span class="line">  i number(2):=1;</span><br><span class="line">begin</span><br><span class="line">  while i&lt;11 loop</span><br><span class="line">  dbms_output.put_line(i);</span><br><span class="line">  i:=i+1;</span><br><span class="line">  end loop;</span><br><span class="line">end;</span><br><span class="line">--exit循环</span><br><span class="line">declare</span><br><span class="line">  i number(2):=1;</span><br><span class="line">begin</span><br><span class="line">  loop</span><br><span class="line">    exit when i&gt;10;</span><br><span class="line">    dbms_output.put_line(i);</span><br><span class="line">    i:=i+1;</span><br><span class="line">  end loop;</span><br><span class="line">end;</span><br><span class="line">--for循环</span><br><span class="line">declare</span><br><span class="line"></span><br><span class="line">begin</span><br><span class="line">  for i in 1..10 loop</span><br><span class="line">    dbms_output.put_line(i);</span><br><span class="line">    end loop;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>

<h5 id="3-5-游标-Cursor"><a href="#3-5-游标-Cursor" class="headerlink" title="3.5 游标 Cursor"></a>3.5 游标 Cursor</h5><p>​    在写 java 程序中有集合的概念，那么在 pl/sql 中也会用到多条记录，这时候我们就要用到游标， 游标可以存储查询返回的多条数据。 </p>
<p>语法：  CURSOR  游标名  [ (参数名  数据类型,参数名 数据类型,…)]  IS  SELECT   语句; </p>
<p>游标的使用步骤： </p>
<p>​         打开游标：      open c1;    (打开游标执行查询) </p>
<p>​         取一行游标的值：fetch c1 into pjob; (取一行到变量中) </p>
<p>​         关闭游标：       close  c1;(关闭游标释放资源) </p>
<p>​         游标的结束方式   exit when c1%notfound </p>
<p>​         注意： 上面的 pjob 必须与 emp表中的 job 列类型一致：    </p>
<p>​            定义：pjob emp.empjob%type; </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">--游标：可以存放多个对象，多行记录</span><br><span class="line">--输出emp表中所有员工的姓名</span><br><span class="line">declare</span><br><span class="line">  cursor c1 is select * from emp;</span><br><span class="line">  emprow emp%rowtype;</span><br><span class="line">begin</span><br><span class="line">  open c1;</span><br><span class="line">     loop</span><br><span class="line">       fetch c1 into emprow;</span><br><span class="line">       exit when c1%notfound;</span><br><span class="line">       dbms_output.put_line(emprow.ename);</span><br><span class="line">     end loop;</span><br><span class="line">  close c1;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">--给指定部门员工涨工资</span><br><span class="line">declare</span><br><span class="line">  cursor c2(eno emp.deptno%type) is select empno from emp where deptno=eno;</span><br><span class="line">  en emp.empno%type;</span><br><span class="line">begin</span><br><span class="line">  open c2(10);</span><br><span class="line">     loop</span><br><span class="line">       fetch c2 into en;</span><br><span class="line">       exit when c2%notfound;</span><br><span class="line">       update emp set sal=sal+100 where empno=en;</span><br><span class="line">       commit;</span><br><span class="line">     end loop;</span><br><span class="line">  close c2;</span><br><span class="line">end;</span><br><span class="line">--查询10号部门员工信息</span><br><span class="line">select * from emp where deptno = 10;</span><br></pre></td></tr></table></figure>

<h4 id="4-存储过程"><a href="#4-存储过程" class="headerlink" title="4. 存储过程"></a>4. 存储过程</h4><p>​    存储过程（Stored Procedure）是在大型数据库系统中，一组为了完成特定功能的 SQL 语句集，经 编译后存储在数据库中，用户通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来 执行它。存储过程是数据库中的一个重要对象，任何一个设计良好的数据库应用程序都应该用到存储过程。 </p>
<p>创建存储过程语法： </p>
<p>​    create [or replace] PROCEDURE 过程名[(参数名 in/out 数据类型)]   </p>
<p>​    AS  </p>
<p>​    begin         </p>
<p>​        PLSQL子程序体； </p>
<p>​    End; </p>
<p>或者 </p>
<p>​    create [or replace] PROCEDURE 过程名[(参数名 in/out 数据类型)]   </p>
<p>​    is </p>
<p>​    begin         </p>
<p>​        PLSQL子程序体； </p>
<p>​    End  过程名; </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">--存储过程：存储过程就是提前已经编译好的一段pl/sql语言，放置在数据库端</span><br><span class="line">--可以直接被调用。这一段pl/sql一般都是固定步骤的业务。</span><br><span class="line">--给指定员工涨100块钱</span><br><span class="line">create or replace procedure p1(eno emp.empno%type)</span><br><span class="line">is</span><br><span class="line">begin</span><br><span class="line">  update emp set sal=sal+100 where empno=eno;</span><br><span class="line">  commit;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">select * from emp where empno=7788;</span><br><span class="line">--测试p1</span><br><span class="line">declare</span><br><span class="line"></span><br><span class="line">begin</span><br><span class="line">  p1(7788);</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>

<h4 id="5-存储函数"><a href="#5-存储函数" class="headerlink" title="5.存储函数"></a>5.存储函数</h4><p>create or replace function 函数名(Name in type, Name in type, …) return 数据类型 is   </p>
<p>​    结果变量 数据类型; </p>
<p>begin      </p>
<p>​    return(结果变量); </p>
<p>end函数名; </p>
<p><strong>存储过程和存储函数的区别</strong> </p>
<p>​    一般来讲，过程和函数的区别在于函数可以有一个返回值；而过程没有返回值。  但过程和函数都可以通过 out 指定一个或多个输出参数。我们可以利用out 参数，在过程和函数中实 现返回多个值。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">--通过存储函数实现计算指定员工的年薪</span><br><span class="line">--存储过程和存储函数的参数都不能带长度</span><br><span class="line">--存储函数的返回值类型不能带长度</span><br><span class="line">create or replace function f_yearsal(eno emp.empno%type)return number</span><br><span class="line">is</span><br><span class="line">  s number(10);</span><br><span class="line">begin</span><br><span class="line">  select sal*12+nvl(comm,0)into s from emp where empno=eno;</span><br><span class="line">  return s;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">--测试f_yearsal</span><br><span class="line">--存储函数在调用的时候，返回值需要接收</span><br><span class="line">declare</span><br><span class="line">  s number(10);</span><br><span class="line">begin</span><br><span class="line">  s:=f_yearsal(7788);</span><br><span class="line">  dbms_output.put_line(s);</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">--out类型参数如何使用</span><br><span class="line">--使用存储过程来算年薪</span><br><span class="line">create or replace procedure p_yearsal(eno emp.empno%type,yearsal out number)</span><br><span class="line">is</span><br><span class="line">  s number(10);</span><br><span class="line">  c emp.comm%type;</span><br><span class="line">begin</span><br><span class="line">  select sal*12,nvl(comm,0)into s,c from emp where empno=eno;</span><br><span class="line">  yearsal:=s+c;</span><br><span class="line">end;</span><br><span class="line">--测试p_yearsal</span><br><span class="line">declare</span><br><span class="line">  yearsal number(10);</span><br><span class="line">begin</span><br><span class="line">  p_yearsal(7788,yearsal);</span><br><span class="line">  dbms_output.put_line(yearsal);</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">--in和out类型参数的区别是什么？</span><br><span class="line">--凡是涉及到into查询语句赋值或者:=赋值操作的参数，都必须使用out来修饰</span><br><span class="line"></span><br><span class="line">--存储过程和存储函数的区别</span><br><span class="line">--语法区别：关键字不一样，</span><br><span class="line">--存储函数比存储过程多了两个return</span><br><span class="line">--本质区别：存储函数有返回值，而存储过程没有返回值。</span><br><span class="line">--如果存储过程想实现有返回值的业务，我们就必须使用out类型的参数</span><br><span class="line">--即便是存储过程使用了out类型的参数，起本质也不是真的有了返回值</span><br><span class="line">--而是在存储过程内部给out类型参数赋值，在执行完毕后，我们直接拿到输出类型参数的值</span><br><span class="line"></span><br><span class="line">--我们可以使用存储函数有返回值的特性，来自定义函数</span><br><span class="line">--而存储过程不能用来自定义函数</span><br><span class="line">--案例需求：查询出员工姓名，员工所在部门名称</span><br><span class="line">--案例准备工作：把scott用户下的dept表复制到当前用户下</span><br><span class="line">create table dept as select * from scott.dept;</span><br><span class="line">--使用传统方式来实现案例需求</span><br><span class="line">select e.ename,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">where e.deptno=d.deptno;</span><br><span class="line">--使用存储函数来实现提供一个部门编号，输出一个部门名称</span><br><span class="line">create or replace function fdna(dno dept.deptno%type)return dept.dname%type</span><br><span class="line">is</span><br><span class="line">  dna dept.dname%type;</span><br><span class="line">begin</span><br><span class="line">  select dname into dna from dept where deptno=dno;</span><br><span class="line">  return dna;</span><br><span class="line">end;</span><br><span class="line">--使用fdna存储函数来实现案例需求：查询出员工姓名，员工所在部门名称</span><br><span class="line">select e.ename,fdna(e.deptno) from emp e;</span><br></pre></td></tr></table></figure>

<h4 id="6-触发器"><a href="#6-触发器" class="headerlink" title="6.触发器"></a>6.触发器</h4><p>​    数据库触发器是一个与表相关联的、存储的 PL/SQL 程序。每当一个特定的数据操作语句(Insert,update,delete)在指定的表上发出时，Oracle 自动地执行触发器中定义的语句序列。 </p>
<p><strong>触发器可用于</strong> </p>
<p>​     数据确认   </p>
<p>​     实施复杂的安全性检查 </p>
<p>​     做审计，跟踪表上所做的数据操作等  </p>
<p>​     数据的备份和同步</p>
<p>*<em>触发器的类型 *</em></p>
<p>​    语句级触发器 ：在指定的操作语句操作之前或之后执行一次，不管这条语句影响了多少行 。  </p>
<p>​    行级触发器（FOR EACH ROW） ：触发语句作用的每一条记录都被触发。在行级触 发器中使用 old 和 new伪记录变量, 识别值的状态。  </p>
<p>语法： </p>
<p>​    CREATE  [or REPLACE] TRIGGER  触发器名    </p>
<p>​        {BEFORE | AFTER}    </p>
<p>​        {DELETE | INSERT | UPDATE [OF 列名]}    </p>
<p>​        ON  表名   </p>
<p>​        [FOR EACH ROW [WHEN(条件) ] ] </p>
<p>​    begin    </p>
<p>​        PLSQL 块  </p>
<p>​    End 触发器名 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">--触发器:就是制定一个规则，在我们做增删改操作的时候，只要满足该规则，自动触发，无需调用</span><br><span class="line">--语句级触发器：不包含有for each row的触发器</span><br><span class="line">--行级触发器：包含有for each row的就是行级触发器</span><br><span class="line">--加for each row是为了使用:old或者:new对象或者一行记录</span><br><span class="line"></span><br><span class="line">--语句级触发器</span><br><span class="line">--插入一条记录，输出一个新员工入职</span><br><span class="line">create or replace trigger t1</span><br><span class="line">after</span><br><span class="line">insert on person</span><br><span class="line">declare</span><br><span class="line">begin</span><br><span class="line">  dbms_output.put_line(&apos;一个新员工入职&apos;);</span><br><span class="line">end;</span><br><span class="line">--触发t1</span><br><span class="line">insert into person values (1, &apos;小红&apos;);</span><br><span class="line">commit;</span><br><span class="line">select * from person;</span><br><span class="line"></span><br><span class="line">--行级别触发器</span><br><span class="line">--不能给员工降薪</span><br><span class="line">create or replace trigger t2</span><br><span class="line">before</span><br><span class="line">update on emp</span><br><span class="line">for each row</span><br><span class="line">  declare</span><br><span class="line">  </span><br><span class="line">  begin</span><br><span class="line">    if:old.sal&gt;:new.sal then</span><br><span class="line">    raise_application_error(-20001,&apos;不能给员工降薪&apos;);</span><br><span class="line">    end if;</span><br><span class="line">  end;</span><br><span class="line">--触发t2</span><br><span class="line">select * from emp where empno = 7788;</span><br><span class="line">update emp set sal=sal-1 where empno = 7788;</span><br><span class="line">commit;</span><br><span class="line"></span><br><span class="line">--触发器实现主键自增。(行级触发器)</span><br><span class="line">--分析：在用户做插入操作的之前，拿到即将插入的数据，给该数据中的主键列赋值</span><br><span class="line">create or replace trigger autoid</span><br><span class="line">before</span><br><span class="line">insert on person</span><br><span class="line">for each row</span><br><span class="line">  declare</span><br><span class="line">  begin</span><br><span class="line">    select s_person.nextval into :new.pid from dual;</span><br><span class="line">  end;</span><br><span class="line">--使用auid实现主键自增</span><br><span class="line">insert into person(pname) values(&apos;a&apos;);</span><br><span class="line">commit;</span><br><span class="line"></span><br><span class="line">--查询person表数据</span><br><span class="line">select * from person;</span><br></pre></td></tr></table></figure>

<h4 id="7-Java程序调用"><a href="#7-Java程序调用" class="headerlink" title="7.Java程序调用"></a>7.Java程序调用</h4><p><strong>导入jar包</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.oracle<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ojdbc14<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>10.2.0.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>OracleDemo</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OracleDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javaCallOracle</span><span class="params">()</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//加载数据库驱动</span></span><br><span class="line">        Class.forName(<span class="string">"oracle.jdbc.driver.OracleDriver"</span>);</span><br><span class="line">        <span class="comment">//得到Connection连接</span></span><br><span class="line">        Connection connection = DriverManager.getConnection(<span class="string">"jdbc:oracle:thin:@192.168.17.130:1521:orcl"</span>, <span class="string">"test1"</span>, <span class="string">"test1"</span>);</span><br><span class="line">        <span class="comment">//得到预编译的ps对象</span></span><br><span class="line">        PreparedStatement ps = connection.prepareStatement(<span class="string">"select * from emp where empno = ?"</span>);</span><br><span class="line">        <span class="comment">//给参数赋值</span></span><br><span class="line">        ps.setObject(<span class="number">1</span>,<span class="number">7788</span>);</span><br><span class="line">        <span class="comment">//执行数据库查询操作</span></span><br><span class="line">        ResultSet rs = ps.executeQuery();</span><br><span class="line">        <span class="comment">//输出结果</span></span><br><span class="line">        <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">            System.out.println(rs.getString(<span class="string">"ename"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//释放资源</span></span><br><span class="line">        rs.close();</span><br><span class="line">        ps.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * java调用存储过程</span></span><br><span class="line"><span class="comment">     * &#123;?= call &lt;procedure-name&gt;[(&lt;arg1&gt;,&lt;arg2&gt;, ...)]&#125;   调用存储函数使用</span></span><br><span class="line"><span class="comment">     *  &#123;call &lt;procedure-name&gt;[(&lt;arg1&gt;,&lt;arg2&gt;, ...)]&#125;   调用存储过程使用</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javaCallProcedure</span><span class="params">()</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//加载数据库驱动</span></span><br><span class="line">        Class.forName(<span class="string">"oracle.jdbc.driver.OracleDriver"</span>);</span><br><span class="line">        <span class="comment">//得到Connection连接</span></span><br><span class="line">        Connection connection = DriverManager.getConnection(<span class="string">"jdbc:oracle:thin:@192.168.17.130:1521:orcl"</span>, <span class="string">"test1"</span>, <span class="string">"test1"</span>);</span><br><span class="line">        <span class="comment">//得到预编译对象</span></span><br><span class="line">        CallableStatement cs = connection.prepareCall(<span class="string">"&#123;call p_yearsal(?,?)&#125;"</span>);</span><br><span class="line">        <span class="comment">//给参数赋值</span></span><br><span class="line">        cs.setObject(<span class="number">1</span>,<span class="number">7788</span>);</span><br><span class="line">        cs.registerOutParameter(<span class="number">2</span>, OracleTypes.NUMBER);</span><br><span class="line">        <span class="comment">//执行数据库查询操作</span></span><br><span class="line">        cs.execute();</span><br><span class="line">        <span class="comment">//输出结果[第二个参数]</span></span><br><span class="line">        System.out.println(cs.getObject(<span class="number">2</span>));</span><br><span class="line">        <span class="comment">//释放资源</span></span><br><span class="line">        cs.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * java调用存储函数</span></span><br><span class="line"><span class="comment">     * &#123;?= call &lt;procedure-name&gt;[(&lt;arg1&gt;,&lt;arg2&gt;, ...)]&#125;   调用存储函数使用</span></span><br><span class="line"><span class="comment">     *  &#123;call &lt;procedure-name&gt;[(&lt;arg1&gt;,&lt;arg2&gt;, ...)]&#125;   调用存储过程使用</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javaCallFunction</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//加载数据库驱动</span></span><br><span class="line">        Class.forName(<span class="string">"oracle.jdbc.driver.OracleDriver"</span>);</span><br><span class="line">        <span class="comment">//得到Connection连接</span></span><br><span class="line">        Connection connection = DriverManager.getConnection(<span class="string">"jdbc:oracle:thin:@192.168.17.130:1521:orcl"</span>, <span class="string">"test1"</span>, <span class="string">"test1"</span>);</span><br><span class="line">        <span class="comment">//得到预编译的Statement对象</span></span><br><span class="line">        CallableStatement cs = connection.prepareCall(<span class="string">"&#123;?= call f_yearsal(?)&#125;"</span>);</span><br><span class="line">        <span class="comment">//给参数赋值</span></span><br><span class="line">        cs.setObject(<span class="number">2</span>, <span class="number">7788</span>);</span><br><span class="line">        cs.registerOutParameter(<span class="number">1</span>, OracleTypes.NUMBER);</span><br><span class="line">        <span class="comment">//执行数据库查询操作</span></span><br><span class="line">        cs.execute();</span><br><span class="line">        <span class="comment">//输出结果[第一个参数]</span></span><br><span class="line">        System.out.println(cs.getObject(<span class="number">1</span>));</span><br><span class="line">        <span class="comment">//释放资源</span></span><br><span class="line">        cs.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
        <div class="reward-container">
  <div>请作者喝瓶肥宅快乐水</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/assets/img/vxpay.jpg" alt="ImOkkkk 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/assets/img/alipay.jpg" alt="ImOkkkk 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/数据库/" rel="tag"><i class="fa fa-tag"></i> 数据库</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/42486/" rel="prev" title="Oracle(一)">
      <i class="fa fa-chevron-left"></i> Oracle(一)
    </a></div>
      <div class="post-nav-item">
    <a href="/35847/" rel="next" title="Redis, Nginx常见面试题">
      Redis, Nginx常见面试题 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-视图"><span class="nav-text">1.视图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-索引"><span class="nav-text">2.索引</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-pl-sql基本语法"><span class="nav-text">3.pl/sql基本语法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-1-pl-sql程序语法"><span class="nav-text">3.1 pl/sql程序语法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-常量和变量定义"><span class="nav-text">3.2 常量和变量定义</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-3-if-分支"><span class="nav-text">3.3 if 分支</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-4-LOOP-循环语句"><span class="nav-text">3.4 LOOP 循环语句</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-5-游标-Cursor"><span class="nav-text">3.5 游标 Cursor</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-存储过程"><span class="nav-text">4. 存储过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-存储函数"><span class="nav-text">5.存储函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-触发器"><span class="nav-text">6.触发器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-Java程序调用"><span class="nav-text">7.Java程序调用</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ImOkkkk"
      src="/../assets/img/head.jpg">
  <p class="site-author-name" itemprop="name">ImOkkkk</p>
  <div class="site-description" itemprop="description">Java开发, 后端开发</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">56</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93ZWliby5jb20vNjA2MjE3MjIyNC8=" title="Weibo → https://weibo.com/6062172224/"><i class="fab fa-weibo fa-fw"></i></span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RvbnltdWE=" title="GitHub → https://github.com/tonymua"><i class="fab fa-github fa-fw"></i></span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOmx3eTA4YUBmb3htYWlsLmNvbQ==" title="E-Mail → mailto:lwy08a@foxmail.com"><i class="fa fa-envelope fa-fw"></i></span>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <a href="https://beian.miit.gov.cn/" target="_blank">皖ICP备19022525号-1</a>

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ImOkkkk</span>
</div><script color="0,137,108" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>



  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  <script src="/js/local-search.js"></script>












  

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'http://tonymua.top/25938/',]
      });
      });
  </script>

</body>
</html>
